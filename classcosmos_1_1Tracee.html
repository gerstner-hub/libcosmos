<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libcosmos: cosmos::Tracee Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libcosmos
   </div>
   <div id="projectbrief">Linux C++ System Programming Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('classcosmos_1_1Tracee.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classcosmos_1_1Tracee-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">cosmos::Tracee Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Thin wrapper class around the <code>ptrace()</code> system call.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a13c909fd8690131c70200894ed2630de" id="r_a13c909fd8690131c70200894ed2630de"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a13c909fd8690131c70200894ed2630de">RestartMode</a> { <br />
&#160;&#160;<b>CONT</b> = to_integral(ptrace::Request::CONT)
, <b>DETACH</b> = to_integral(ptrace::Request::DETACH)
, <b>SYSCALL</b> = to_integral(ptrace::Request::SYSCALL)
, <b>SINGLESTEP</b> = to_integral(ptrace::Request::SINGLESTEP)
, <br />
&#160;&#160;<b>LISTEN</b> = to_integral(ptrace::Request::LISTEN)
<br />
 }</td></tr>
<tr class="memdesc:a13c909fd8690131c70200894ed2630de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Different ways to restart a tracee.  <a href="#a13c909fd8690131c70200894ed2630de">More...</a><br /></td></tr>
<tr class="separator:a13c909fd8690131c70200894ed2630de"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6e5de903ed7a29a5dad0bb73ac731417" id="r_a6e5de903ed7a29a5dad0bb73ac731417"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6e5de903ed7a29a5dad0bb73ac731417">Tracee</a> (const <a class="el" href="proc_2types_8hxx.html#a4c274565c8010d58379ba7ac3d6e0d9a">ProcessID</a> pid=ProcessID::INVALID)</td></tr>
<tr class="separator:a6e5de903ed7a29a5dad0bb73ac731417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae91657195f3ad8a45c6ef05577949824" id="r_ae91657195f3ad8a45c6ef05577949824"><td class="memItemLeft" align="right" valign="top"><a class="el" href="proc_2types_8hxx.html#a4c274565c8010d58379ba7ac3d6e0d9a">ProcessID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae91657195f3ad8a45c6ef05577949824">pid</a> () const</td></tr>
<tr class="separator:ae91657195f3ad8a45c6ef05577949824"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17d3745c4cb054345cf75af09bfa5f47" id="r_a17d3745c4cb054345cf75af09bfa5f47"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a17d3745c4cb054345cf75af09bfa5f47">valid</a> () const</td></tr>
<tr class="separator:a17d3745c4cb054345cf75af09bfa5f47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a968432f97b30f27034234657f4feaa6b" id="r_a968432f97b30f27034234657f4feaa6b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a968432f97b30f27034234657f4feaa6b">seize</a> (const <a class="el" href="classcosmos_1_1BitMask.html">ptrace::Opts</a> opts)</td></tr>
<tr class="memdesc:a968432f97b30f27034234657f4feaa6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Seize a tracee.  <br /></td></tr>
<tr class="separator:a968432f97b30f27034234657f4feaa6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1de9f10eef0e0ee6f2a61b5759db291" id="r_ac1de9f10eef0e0ee6f2a61b5759db291"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac1de9f10eef0e0ee6f2a61b5759db291">attach</a> ()</td></tr>
<tr class="memdesc:ac1de9f10eef0e0ee6f2a61b5759db291"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attach to a process, making it a tracee.  <br /></td></tr>
<tr class="separator:ac1de9f10eef0e0ee6f2a61b5759db291"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8785ac430ddac58225e81d74a7b4d6d" id="r_ac8785ac430ddac58225e81d74a7b4d6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac8785ac430ddac58225e81d74a7b4d6d">detach</a> ()</td></tr>
<tr class="memdesc:ac8785ac430ddac58225e81d74a7b4d6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detach from and restart the tracee.  <br /></td></tr>
<tr class="separator:ac8785ac430ddac58225e81d74a7b4d6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af50c00c9d07f00812e55e288c97d0c40" id="r_af50c00c9d07f00812e55e288c97d0c40"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af50c00c9d07f00812e55e288c97d0c40">restart</a> (const <a class="el" href="#a13c909fd8690131c70200894ed2630de">RestartMode</a> mode, const std::optional&lt; <a class="el" href="classcosmos_1_1Signal.html">Signal</a> &gt; signal={})</td></tr>
<tr class="memdesc:af50c00c9d07f00812e55e288c97d0c40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Continues a traced process, optionally delivering <code>signal</code>.  <br /></td></tr>
<tr class="separator:af50c00c9d07f00812e55e288c97d0c40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63c81ded0c902d5ec3ccbc9966749d13" id="r_a63c81ded0c902d5ec3ccbc9966749d13"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a63c81ded0c902d5ec3ccbc9966749d13">interrupt</a> ()</td></tr>
<tr class="memdesc:a63c81ded0c902d5ec3ccbc9966749d13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interrupt the tracee.  <br /></td></tr>
<tr class="separator:a63c81ded0c902d5ec3ccbc9966749d13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3b5f159473a8be7a0e74c1b593f58e2" id="r_aa3b5f159473a8be7a0e74c1b593f58e2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa3b5f159473a8be7a0e74c1b593f58e2">setOptions</a> (const <a class="el" href="classcosmos_1_1BitMask.html">ptrace::Opts</a> opts)</td></tr>
<tr class="memdesc:aa3b5f159473a8be7a0e74c1b593f58e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set tracing options for the given tracee.  <br /></td></tr>
<tr class="separator:aa3b5f159473a8be7a0e74c1b593f58e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f5eeb63d1485e982060ea22d1298573" id="r_a9f5eeb63d1485e982060ea22d1298573"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9f5eeb63d1485e982060ea22d1298573">peekData</a> (const long *addr) const</td></tr>
<tr class="memdesc:a9f5eeb63d1485e982060ea22d1298573"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read one word of data from the tracee's memory.  <br /></td></tr>
<tr class="separator:a9f5eeb63d1485e982060ea22d1298573"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a871a3986682db6c4745933eeb0e2f67b" id="r_a871a3986682db6c4745933eeb0e2f67b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a871a3986682db6c4745933eeb0e2f67b">pokeData</a> (const long *addr, long value)</td></tr>
<tr class="memdesc:a871a3986682db6c4745933eeb0e2f67b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write one word of data into the tracee's memory.  <br /></td></tr>
<tr class="separator:a871a3986682db6c4745933eeb0e2f67b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab885b1d2e0bbc99d63db5a32de435b6c" id="r_ab885b1d2e0bbc99d63db5a32de435b6c"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab885b1d2e0bbc99d63db5a32de435b6c">peekUser</a> (const long *offset) const</td></tr>
<tr class="memdesc:ab885b1d2e0bbc99d63db5a32de435b6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read one word of data from the tracee's user area.  <br /></td></tr>
<tr class="separator:ab885b1d2e0bbc99d63db5a32de435b6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0a46160569f645dbfbf01818f038da5" id="r_af0a46160569f645dbfbf01818f038da5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af0a46160569f645dbfbf01818f038da5">pokeUser</a> (const long *offset, long value)</td></tr>
<tr class="memdesc:af0a46160569f645dbfbf01818f038da5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change one word of data in the tracee's user area.  <br /></td></tr>
<tr class="separator:af0a46160569f645dbfbf01818f038da5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc72ae9be72090cad317fa84257d34de" id="r_afc72ae9be72090cad317fa84257d34de"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afc72ae9be72090cad317fa84257d34de">getRegisters</a> (struct user_regs_struct &amp;out) const</td></tr>
<tr class="memdesc:afc72ae9be72090cad317fa84257d34de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy the tracee's general purpose registers into the provided structure.  <br /></td></tr>
<tr class="separator:afc72ae9be72090cad317fa84257d34de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cda1e5d38ad2243b4cee1bac1911404" id="r_a2cda1e5d38ad2243b4cee1bac1911404"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2cda1e5d38ad2243b4cee1bac1911404">setRegisters</a> (const struct user_regs_struct &amp;out)</td></tr>
<tr class="memdesc:a2cda1e5d38ad2243b4cee1bac1911404"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modify the tracee's general purpose registers.  <br /></td></tr>
<tr class="separator:a2cda1e5d38ad2243b4cee1bac1911404"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af21220e05519e5226dd680359e0ee9f4" id="r_af21220e05519e5226dd680359e0ee9f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af21220e05519e5226dd680359e0ee9f4">getFloatRegisters</a> (struct user_fpregs_struct &amp;out) const</td></tr>
<tr class="memdesc:af21220e05519e5226dd680359e0ee9f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy the tracee's floating point registers into the provided structure.  <br /></td></tr>
<tr class="separator:af21220e05519e5226dd680359e0ee9f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11f4b897829d82773cd4420a554243fa" id="r_a11f4b897829d82773cd4420a554243fa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a11f4b897829d82773cd4420a554243fa">setFloatRegisters</a> (const struct user_fpregs_struct &amp;out)</td></tr>
<tr class="memdesc:a11f4b897829d82773cd4420a554243fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modify the tracee's floating point registers.  <br /></td></tr>
<tr class="separator:a11f4b897829d82773cd4420a554243fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a496109c8f9d527121e2f0f2ae0dc15c5" id="r_a496109c8f9d527121e2f0f2ae0dc15c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a496109c8f9d527121e2f0f2ae0dc15c5">getRegisterSet</a> (const <a class="el" href="ptrace_8hxx.html#a8cf6234aa2df092f270d9a5de0ba190f">ptrace::RegisterType</a> type, <a class="el" href="structcosmos_1_1InputMemoryRegion.html">InputMemoryRegion</a> &amp;iovec) const</td></tr>
<tr class="memdesc:a496109c8f9d527121e2f0f2ae0dc15c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a set of registers from the tracee.  <br /></td></tr>
<tr class="separator:a496109c8f9d527121e2f0f2ae0dc15c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6524b926fdaaece495a139a7c2021742" id="r_a6524b926fdaaece495a139a7c2021742"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6524b926fdaaece495a139a7c2021742">setRegisterSet</a> (const <a class="el" href="ptrace_8hxx.html#a8cf6234aa2df092f270d9a5de0ba190f">ptrace::RegisterType</a> type, <a class="el" href="structcosmos_1_1OutputMemoryRegion.html">OutputMemoryRegion</a> &amp;iovec)</td></tr>
<tr class="memdesc:a6524b926fdaaece495a139a7c2021742"><td class="mdescLeft">&#160;</td><td class="mdescRight">Modify a set of registers in the tracee.  <br /></td></tr>
<tr class="separator:a6524b926fdaaece495a139a7c2021742"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0ea2fdf1b7bd9aaa4915f52c772013b" id="r_ac0ea2fdf1b7bd9aaa4915f52c772013b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac0ea2fdf1b7bd9aaa4915f52c772013b">getSigInfo</a> (<a class="el" href="classcosmos_1_1SigInfo.html">SigInfo</a> &amp;info) const</td></tr>
<tr class="memdesc:ac0ea2fdf1b7bd9aaa4915f52c772013b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain information about the signal that caused the stop.  <br /></td></tr>
<tr class="separator:ac0ea2fdf1b7bd9aaa4915f52c772013b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a734c8731ffacba884ddaebfa46d76892" id="r_a734c8731ffacba884ddaebfa46d76892"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a734c8731ffacba884ddaebfa46d76892">setSigInfo</a> (const <a class="el" href="classcosmos_1_1SigInfo.html">SigInfo</a> &amp;info)</td></tr>
<tr class="memdesc:a734c8731ffacba884ddaebfa46d76892"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set signal information for the tracee.  <br /></td></tr>
<tr class="separator:a734c8731ffacba884ddaebfa46d76892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a0869e4a7832b750f363f93a3e0d361" id="r_a2a0869e4a7832b750f363f93a3e0d361"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classcosmos_1_1SigInfo.html">SigInfo</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2a0869e4a7832b750f363f93a3e0d361">peekSigInfo</a> (const <a class="el" href="classcosmos_1_1ptrace_1_1PeekSigInfo.html">ptrace::PeekSigInfo</a> &amp;settings)</td></tr>
<tr class="memdesc:a2a0869e4a7832b750f363f93a3e0d361"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtains <a class="el" href="classcosmos_1_1SigInfo.html" title="Signal information struct used when receiving signals.">SigInfo</a> structures pending for the tracee.  <br /></td></tr>
<tr class="separator:a2a0869e4a7832b750f363f93a3e0d361"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0dcf6d0867ecd5b20a77c2e1a803f6a" id="r_af0dcf6d0867ecd5b20a77c2e1a803f6a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af0dcf6d0867ecd5b20a77c2e1a803f6a">getSigMask</a> (<a class="el" href="classcosmos_1_1SigSet.html">SigSet</a> &amp;set) const</td></tr>
<tr class="memdesc:af0dcf6d0867ecd5b20a77c2e1a803f6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain the tracee's mask of blocked signals.  <br /></td></tr>
<tr class="separator:af0dcf6d0867ecd5b20a77c2e1a803f6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a173bcd08cf9740bc26cb5a2168c12c70" id="r_a173bcd08cf9740bc26cb5a2168c12c70"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a173bcd08cf9740bc26cb5a2168c12c70">setSigMask</a> (const <a class="el" href="classcosmos_1_1SigSet.html">SigSet</a> &amp;set)</td></tr>
<tr class="memdesc:a173bcd08cf9740bc26cb5a2168c12c70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change the tracee's mask of blocked signals.  <br /></td></tr>
<tr class="separator:a173bcd08cf9740bc26cb5a2168c12c70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59698473cee595aedaa01ee96c214569" id="r_a59698473cee595aedaa01ee96c214569"><td class="memItemLeft" align="right" valign="top"><a class="el" href="proc_2types_8hxx.html#a4c274565c8010d58379ba7ac3d6e0d9a">ProcessID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a59698473cee595aedaa01ee96c214569">getPIDEventMsg</a> () const</td></tr>
<tr class="memdesc:a59698473cee595aedaa01ee96c214569"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the PID of a newly created child of the tracee in the context of a ptrace-event-stop.  <br /></td></tr>
<tr class="separator:a59698473cee595aedaa01ee96c214569"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30e73b270a2c5a348a4e32c57ffe1bfc" id="r_a30e73b270a2c5a348a4e32c57ffe1bfc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="proc_2types_8hxx.html#aaa4c881d3282ef52c697a66a456d9c97">ExitStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a30e73b270a2c5a348a4e32c57ffe1bfc">getExitEventMsg</a> () const</td></tr>
<tr class="memdesc:a30e73b270a2c5a348a4e32c57ffe1bfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the exit code of the tracee in the context of a ptrace-event-stop.  <br /></td></tr>
<tr class="separator:a30e73b270a2c5a348a4e32c57ffe1bfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a137298b99ea1ec58e7bf1463b9e38d13" id="r_a137298b99ea1ec58e7bf1463b9e38d13"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a137298b99ea1ec58e7bf1463b9e38d13">getSeccompRetDataEventMsg</a> () const</td></tr>
<tr class="memdesc:a137298b99ea1ec58e7bf1463b9e38d13"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the SECCOMP_RET_DATA in the context of a ptrace-event-stop.  <br /></td></tr>
<tr class="separator:a137298b99ea1ec58e7bf1463b9e38d13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc46d804de43e3abe2da909f78f74111" id="r_adc46d804de43e3abe2da909f78f74111"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adc46d804de43e3abe2da909f78f74111">getSeccompFilter</a> (std::vector&lt; struct sock_filter &gt; &amp;instructions, const unsigned long prog_index) const</td></tr>
<tr class="memdesc:adc46d804de43e3abe2da909f78f74111"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a classic seccomp BPF program installed in the tracee.  <br /></td></tr>
<tr class="separator:adc46d804de43e3abe2da909f78f74111"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad868f8e5d6b18b4ef2c569fdb4f98c35" id="r_ad868f8e5d6b18b4ef2c569fdb4f98c35"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad868f8e5d6b18b4ef2c569fdb4f98c35">getSyscallInfo</a> (<a class="el" href="structcosmos_1_1ptrace_1_1SyscallInfo.html">ptrace::SyscallInfo</a> &amp;info) const</td></tr>
<tr class="memdesc:ad868f8e5d6b18b4ef2c569fdb4f98c35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns system call information in the context of the current ptrace stop.  <br /></td></tr>
<tr class="separator:ad868f8e5d6b18b4ef2c569fdb4f98c35"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:afb7e548fe0ae620ca51a784a55763324" id="r_afb7e548fe0ae620ca51a784a55763324"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afb7e548fe0ae620ca51a784a55763324">getEventMsg</a> () const</td></tr>
<tr class="memdesc:afb7e548fe0ae620ca51a784a55763324"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the current event message for a ptrace-event-stop.  <br /></td></tr>
<tr class="separator:afb7e548fe0ae620ca51a784a55763324"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e0e790421dea9708d1fba889ed9b34e" id="r_a4e0e790421dea9708d1fba889ed9b34e"><td class="memTemplParams" colspan="2">template&lt;typename ADDR  = void*, typename DATA  = void*&gt; </td></tr>
<tr class="memitem:a4e0e790421dea9708d1fba889ed9b34e"><td class="memTemplItemLeft" align="right" valign="top">std::optional&lt; long &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a4e0e790421dea9708d1fba889ed9b34e">request</a> (const <a class="el" href="ptrace_8hxx.html#a5c84789f5ce6e305df719009e982a157">ptrace::Request</a> req, ADDR addr=nullptr, DATA data=nullptr) const</td></tr>
<tr class="separator:a4e0e790421dea9708d1fba889ed9b34e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c53169a343594c9df341f2966951588" id="r_a0c53169a343594c9df341f2966951588"><td class="memTemplParams" colspan="2">template&lt;typename DATA  = void*&gt; </td></tr>
<tr class="memitem:a0c53169a343594c9df341f2966951588"><td class="memTemplItemLeft" align="right" valign="top">std::optional&lt; long &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a0c53169a343594c9df341f2966951588">request</a> (const <a class="el" href="ptrace_8hxx.html#a5c84789f5ce6e305df719009e982a157">ptrace::Request</a> req, std::nullptr_t, DATA data=nullptr) const</td></tr>
<tr class="separator:a0c53169a343594c9df341f2966951588"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a1f61416f3d6309755f5a8b5050227883" id="r_a1f61416f3d6309755f5a8b5050227883"><td class="memItemLeft" align="right" valign="top"><a class="el" href="proc_2types_8hxx.html#a4c274565c8010d58379ba7ac3d6e0d9a">ProcessID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1f61416f3d6309755f5a8b5050227883">m_pid</a></td></tr>
<tr class="separator:a1f61416f3d6309755f5a8b5050227883"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Thin wrapper class around the <code>ptrace()</code> system call. </p>
<p>This is a type safe wrapper around the <code>ptrace()</code> system call. An instance of this type always operates on the same process supplied during construction time. There are no resources managed by this class.</p>
<p>The ptrace() API is highly complex and this class can only offer some basic wrappers and documentation about it. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00041">41</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a13c909fd8690131c70200894ed2630de" name="a13c909fd8690131c70200894ed2630de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13c909fd8690131c70200894ed2630de">&#9670;&#160;</a></span>RestartMode</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="#a13c909fd8690131c70200894ed2630de">cosmos::Tracee::RestartMode</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Different ways to restart a tracee. </p>
<p>This is a sub-set of the commands from <a class="el" href="ptrace_8hxx.html#a5c84789f5ce6e305df719009e982a157" title="Basic requests that can be passed to the ptrace() system call.">ptrace::Request</a> that deal with restarting the tracee in different ways. All of these requests optionally accept a signal to inject, except for RestartMode::LISTEN. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00051">51</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   51</span>                               {</div>
<div class="line"><span class="lineno">   52</span>                CONT              = to_integral(ptrace::Request::CONT),</div>
<div class="line"><span class="lineno">   53</span>                <a class="code hl_enumvalue" href="ptrace_8hxx.html#a5c84789f5ce6e305df719009e982a157a36b709e0b9f2710e86bade3966143a15">DETACH</a>            = to_integral(ptrace::Request::DETACH),</div>
<div class="line"><span class="lineno">   54</span>                <a class="code hl_enumvalue" href="ptrace_8hxx.html#a5c84789f5ce6e305df719009e982a157a45f1e61f22cb04eb7a6a39016b56db9b">SYSCALL</a>           = to_integral(ptrace::Request::SYSCALL),</div>
<div class="line"><span class="lineno">   55</span>                <a class="code hl_enumvalue" href="ptrace_8hxx.html#a5c84789f5ce6e305df719009e982a157aeeccd61f1d9dbe457038a5f3d2a53f62">SINGLESTEP</a>        = to_integral(ptrace::Request::SINGLESTEP),</div>
<div class="line"><span class="lineno">   56</span><span class="preprocessor">#ifdef PTRACE_SYSEMU</span></div>
<div class="line"><span class="lineno">   57</span>                SYSEMU            = to_integral(ptrace::Request::SYSEMU),</div>
<div class="line"><span class="lineno">   58</span>                SYSEMU_SINGLESTEP = to_integral(ptrace::Request::SYSEMU_SINGLESTEP),</div>
<div class="line"><span class="lineno">   59</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   60</span>                <a class="code hl_enumvalue" href="ptrace_8hxx.html#a5c84789f5ce6e305df719009e982a157ac1f9314a03f63f33410be3489b12b29b">LISTEN</a>            = to_integral(ptrace::Request::LISTEN)</div>
<div class="line"><span class="lineno">   61</span>        };</div>
<div class="ttc" id="aptrace_8hxx_html_a5c84789f5ce6e305df719009e982a157a36b709e0b9f2710e86bade3966143a15"><div class="ttname"><a href="ptrace_8hxx.html#a5c84789f5ce6e305df719009e982a157a36b709e0b9f2710e86bade3966143a15">cosmos::ptrace::Request::DETACH</a></div><div class="ttdeci">@ DETACH</div><div class="ttdoc">Restart the stopped tracee, but first detach from it.</div></div>
<div class="ttc" id="aptrace_8hxx_html_a5c84789f5ce6e305df719009e982a157a45f1e61f22cb04eb7a6a39016b56db9b"><div class="ttname"><a href="ptrace_8hxx.html#a5c84789f5ce6e305df719009e982a157a45f1e61f22cb04eb7a6a39016b56db9b">cosmos::ptrace::Request::SYSCALL</a></div><div class="ttdeci">@ SYSCALL</div><div class="ttdoc">Restart the stopped tracee like CONT, but arrange for the tracee to be stopped at entry/exit to/from ...</div></div>
<div class="ttc" id="aptrace_8hxx_html_a5c84789f5ce6e305df719009e982a157ac1f9314a03f63f33410be3489b12b29b"><div class="ttname"><a href="ptrace_8hxx.html#a5c84789f5ce6e305df719009e982a157ac1f9314a03f63f33410be3489b12b29b">cosmos::ptrace::Request::LISTEN</a></div><div class="ttdeci">@ LISTEN</div><div class="ttdoc">Restart a stopped tracee, but let it enter a SIGSTOP like state. Works only for SEIZE'd tracees.</div></div>
<div class="ttc" id="aptrace_8hxx_html_a5c84789f5ce6e305df719009e982a157aeeccd61f1d9dbe457038a5f3d2a53f62"><div class="ttname"><a href="ptrace_8hxx.html#a5c84789f5ce6e305df719009e982a157aeeccd61f1d9dbe457038a5f3d2a53f62">cosmos::ptrace::Request::SINGLESTEP</a></div><div class="ttdeci">@ SINGLESTEP</div><div class="ttdoc">Like SYSCALL, but arrange for the tracee to be stopped after a single instruction.</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a6e5de903ed7a29a5dad0bb73ac731417" name="a6e5de903ed7a29a5dad0bb73ac731417"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e5de903ed7a29a5dad0bb73ac731417">&#9670;&#160;</a></span>Tracee()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cosmos::Tracee::Tracee </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="proc_2types_8hxx.html#a4c274565c8010d58379ba7ac3d6e0d9a">ProcessID</a></td>          <td class="paramname"><span class="paramname"><em>pid</em></span><span class="paramdefsep"> = </span><span class="paramdefval">ProcessID::INVALID</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00065">65</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   65</span>                                                                :</div>
<div class="line"><span class="lineno">   66</span>                        m_pid{pid}</div>
<div class="line"><span class="lineno">   67</span>        {}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ac1de9f10eef0e0ee6f2a61b5759db291" name="ac1de9f10eef0e0ee6f2a61b5759db291"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1de9f10eef0e0ee6f2a61b5759db291">&#9670;&#160;</a></span>attach()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::attach </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attach to a process, making it a tracee. </p>
<p>This is the old method of making a process a tracee. Tracers attached to this way don't support all ptrace() operations and it is not recommended to use this method anymore.</p>
<p>The tracee will be sent a SIGSTOP signal, the tracer needs to wait on the tracee to assert it has entered stop state as a result of the attach operation. The synthetic SIGSTOP event should be suppressed by the tracer.</p>
<p>This method of attaching to the tracee has inherent race conditions. Other signals can concurrently occur while the tracer attempts to attach to it. Events other than SIGSTOP should be reinjected until SIGSTOP is observed. This does not reliably work if SIGSTOP itself is occurring in parallel, making <a class="el" href="#ac1de9f10eef0e0ee6f2a61b5759db291" title="Attach to a process, making it a tracee.">attach()</a> unreliable. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00110">110</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  110</span>                      {</div>
<div class="line"><span class="lineno">  111</span>                this-&gt;request(ptrace::Request::ATTACH);</div>
<div class="line"><span class="lineno">  112</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac8785ac430ddac58225e81d74a7b4d6d" name="ac8785ac430ddac58225e81d74a7b4d6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8785ac430ddac58225e81d74a7b4d6d">&#9670;&#160;</a></span>detach()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::detach </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Detach from and restart the tracee. </p>
<p>The tracee will be restarted (if currently in a tracing stop), the process will no longer be traced. This method can be used regardless of whether the tracee was <a class="el" href="#a968432f97b30f27034234657f4feaa6b" title="Seize a tracee.">seize()</a>'d or <a class="el" href="#ac1de9f10eef0e0ee6f2a61b5759db291" title="Attach to a process, making it a tracee.">attach()</a>'d to. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00120">120</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  120</span>                      {</div>
<div class="line"><span class="lineno">  121</span>                this-&gt;request(ptrace::Request::DETACH);</div>
<div class="line"><span class="lineno">  122</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afb7e548fe0ae620ca51a784a55763324" name="afb7e548fe0ae620ca51a784a55763324"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb7e548fe0ae620ca51a784a55763324">&#9670;&#160;</a></span>getEventMsg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long cosmos::Tracee::getEventMsg </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the current event message for a ptrace-event-stop. </p>
<p>The interpretation of the returned value depends on the <a class="el" href="ptrace_8hxx.html#a9a489662d1a635d981aed845ab5d146f" title="Different events that can occur in a tracee leading to ptrace-event-stop.">ptrace::Event</a> that has been reported. If there is no (matching) ptrace-event, then the return value seems to be undefined. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00409">409</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  409</span>                                          {</div>
<div class="line"><span class="lineno">  410</span>                <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> msg = 0;</div>
<div class="line"><span class="lineno">  411</span>                this-&gt;request(ptrace::Request::GETEVENTMSG, <span class="keyword">nullptr</span>, &amp;msg);</div>
<div class="line"><span class="lineno">  412</span>                <span class="keywordflow">return</span> msg;</div>
<div class="line"><span class="lineno">  413</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a30e73b270a2c5a348a4e32c57ffe1bfc" name="a30e73b270a2c5a348a4e32c57ffe1bfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30e73b270a2c5a348a4e32c57ffe1bfc">&#9670;&#160;</a></span>getExitEventMsg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="proc_2types_8hxx.html#aaa4c881d3282ef52c697a66a456d9c97">ExitStatus</a> cosmos::Tracee::getExitEventMsg </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the exit code of the tracee in the context of a ptrace-event-stop. </p>
<p>This request is only valid during a ptrace-event-stop when <a class="el" href="ptrace_8hxx.html#a9a489662d1a635d981aed845ab5d146faa42b2fb0e720a080e79a92f4ca97d927" title="exit() is upcoming.">ptrace::Event::EXIT</a> is reported.</p>
<p>The return value is the exit status of the exited tracee process. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00331">331</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  331</span>                                           {</div>
<div class="line"><span class="lineno">  332</span>                <span class="keyword">const</span> <span class="keyword">auto</span> status = <a class="code hl_function" href="#afb7e548fe0ae620ca51a784a55763324">getEventMsg</a>();</div>
<div class="line"><span class="lineno">  333</span>                <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="proc_2types_8hxx.html#aaa4c881d3282ef52c697a66a456d9c97">ExitStatus</a><span class="keyword">&gt;</span>(status);</div>
<div class="line"><span class="lineno">  334</span>        }</div>
<div class="ttc" id="aclasscosmos_1_1Tracee_html_afb7e548fe0ae620ca51a784a55763324"><div class="ttname"><a href="#afb7e548fe0ae620ca51a784a55763324">cosmos::Tracee::getEventMsg</a></div><div class="ttdeci">unsigned long getEventMsg() const</div><div class="ttdoc">Returns the current event message for a ptrace-event-stop.</div><div class="ttdef"><b>Definition</b> <a href="Tracee_8hxx_source.html#l00409">Tracee.hxx:409</a></div></div>
<div class="ttc" id="aproc_2types_8hxx_html_aaa4c881d3282ef52c697a66a456d9c97"><div class="ttname"><a href="proc_2types_8hxx.html#aaa4c881d3282ef52c697a66a456d9c97">cosmos::ExitStatus</a></div><div class="ttdeci">ExitStatus</div><div class="ttdoc">Represents an exit status code from a child process.</div><div class="ttdef"><b>Definition</b> <a href="proc_2types_8hxx_source.html#l00043">types.hxx:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af21220e05519e5226dd680359e0ee9f4" name="af21220e05519e5226dd680359e0ee9f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af21220e05519e5226dd680359e0ee9f4">&#9670;&#160;</a></span>getFloatRegisters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::getFloatRegisters </td>
          <td>(</td>
          <td class="paramtype">struct user_fpregs_struct &amp;</td>          <td class="paramname"><span class="paramname"><em>out</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy the tracee's floating point registers into the provided structure. </p>
<p>This is similar to <a class="el" href="#afc72ae9be72090cad317fa84257d34de" title="Copy the tracee&#39;s general purpose registers into the provided structure.">getRegisters()</a> but provides the floating point registers instead.</p>
<p>Preferably use <a class="el" href="#a496109c8f9d527121e2f0f2ae0dc15c5" title="Retrieve a set of registers from the tracee.">getRegisterSet()</a> instead. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00243">243</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  243</span>                                                                     {</div>
<div class="line"><span class="lineno">  244</span>                <span class="comment">// NOTE: see getRegisters() about Sparc architecture</span></div>
<div class="line"><span class="lineno">  245</span>                this-&gt;request(ptrace::Request::GETFPREGS, <span class="keyword">nullptr</span>, &amp;out);</div>
<div class="line"><span class="lineno">  246</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a59698473cee595aedaa01ee96c214569" name="a59698473cee595aedaa01ee96c214569"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59698473cee595aedaa01ee96c214569">&#9670;&#160;</a></span>getPIDEventMsg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="proc_2types_8hxx.html#a4c274565c8010d58379ba7ac3d6e0d9a">ProcessID</a> cosmos::Tracee::getPIDEventMsg </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the PID of a newly created child of the tracee in the context of a ptrace-event-stop. </p>
<p>This request is only valid during a ptrace-event-stop and when <a class="el" href="ptrace_8hxx.html#a9a489662d1a635d981aed845ab5d146faa59a5773c21e7a30b474d0b16ac5e8d2" title="fork() (or clone with SIGCHLD as exit signal) is upcoming.">ptrace::Event::FORK</a>, ptrace::EVENT::VFORK, <a class="el" href="ptrace_8hxx.html#a9a489662d1a635d981aed845ab5d146faecd0acce6193b4b2fc3d012586b9eadb" title="vfork() (or clone() with VFORK flag) was finished but not yet returned.">ptrace::Event::VFORK_DONE</a> or <a class="el" href="ptrace_8hxx.html#a9a489662d1a635d981aed845ab5d146faa6ddc0995d7b58e0302675f581845cce" title="clone() is upcoming.">ptrace::Event::CLONE</a> is reported.</p>
<p>The return value is the PID of the newly created child process. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00319">319</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  319</span>                                         {</div>
<div class="line"><span class="lineno">  320</span>                <span class="keyword">const</span> <span class="keyword">auto</span> pid = <a class="code hl_function" href="#afb7e548fe0ae620ca51a784a55763324">getEventMsg</a>();</div>
<div class="line"><span class="lineno">  321</span>                <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="proc_2types_8hxx.html#a4c274565c8010d58379ba7ac3d6e0d9a">ProcessID</a><span class="keyword">&gt;</span>(pid);</div>
<div class="line"><span class="lineno">  322</span>        }</div>
<div class="ttc" id="aproc_2types_8hxx_html_a4c274565c8010d58379ba7ac3d6e0d9a"><div class="ttname"><a href="proc_2types_8hxx.html#a4c274565c8010d58379ba7ac3d6e0d9a">cosmos::ProcessID</a></div><div class="ttdeci">ProcessID</div><div class="ttdef"><b>Definition</b> <a href="proc_2types_8hxx_source.html#l00025">types.hxx:25</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afc72ae9be72090cad317fa84257d34de" name="afc72ae9be72090cad317fa84257d34de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc72ae9be72090cad317fa84257d34de">&#9670;&#160;</a></span>getRegisters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::getRegisters </td>
          <td>(</td>
          <td class="paramtype">struct user_regs_struct &amp;</td>          <td class="paramname"><span class="paramname"><em>out</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy the tracee's general purpose registers into the provided structure. </p>
<p>You need to include sys/user.h and check out the data structure found in there for details. This is a low level structure specially designed for GDB and also not available on all architectures.</p>
<p>Preferably use <a class="el" href="#a496109c8f9d527121e2f0f2ae0dc15c5" title="Retrieve a set of registers from the tracee.">getRegisterSet()</a> instead. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00219">219</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  219</span>                                                              {</div>
<div class="line"><span class="lineno">  220</span>                <span class="comment">// NOTE: on Sparc the address needs to be passed as third</span></div>
<div class="line"><span class="lineno">  221</span>                <span class="comment">// argument, not as fourth. If we should ever want to support</span></div>
<div class="line"><span class="lineno">  222</span>                <span class="comment">// it, we&#39;d need an #ifdef of some sort.</span></div>
<div class="line"><span class="lineno">  223</span>                this-&gt;request(ptrace::Request::GETREGS, <span class="keyword">nullptr</span>, &amp;out);</div>
<div class="line"><span class="lineno">  224</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a496109c8f9d527121e2f0f2ae0dc15c5" name="a496109c8f9d527121e2f0f2ae0dc15c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a496109c8f9d527121e2f0f2ae0dc15c5">&#9670;&#160;</a></span>getRegisterSet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::getRegisterSet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ptrace_8hxx.html#a8cf6234aa2df092f270d9a5de0ba190f">ptrace::RegisterType</a></td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcosmos_1_1InputMemoryRegion.html">InputMemoryRegion</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>iovec</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve a set of registers from the tracee. </p>
<p>This retrieves binary data based on an I/O vector. For ptrace::RegisterType::GENERAL_PURPOSE the target data structure is found in elf.h called <code>elf_gregset_t</code>.</p>
<p>The kernel will update <code>iovec</code> to reflect the actual amount of data that has been returned. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00265">265</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  265</span>                                                                                           {</div>
<div class="line"><span class="lineno">  266</span>                this-&gt;request(ptrace::Request::GETREGSET, type, iovec.asIovec());</div>
<div class="line"><span class="lineno">  267</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="adc46d804de43e3abe2da909f78f74111" name="adc46d804de43e3abe2da909f78f74111"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc46d804de43e3abe2da909f78f74111">&#9670;&#160;</a></span>getSeccompFilter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::getSeccompFilter </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; struct sock_filter &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>instructions</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned long</td>          <td class="paramname"><span class="paramname"><em>prog_index</em></span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve a classic seccomp BPF program installed in the tracee. </p>
<p><code>prog_index</code> is the index of the program to return, where index 0 is the most recently installed program. If the index is greater than the number of installed programs then an <a class="el" href="classcosmos_1_1ApiError.html" title="Specialized exception type used when system APIs fail.">ApiError</a> with <a class="el" href="errno_8hxx.html#a5c1aef3a972b5a9a3bb6b3df1aa01939a1f60ae3892e15c97e8ed2812e5d13181" title="no such file or directory (or otherwise an object was not found)">Errno::NO_ENTRY</a> is thrown.</p>
<p>If <code>instructions</code> is empty then the call will first ask the kernel how big the given program is, to dimension <code>instructions</code> accordingly. In a second call the program is retrieved into the vector.</p>
<p>If <code>instructions</code> is non-empty then the provided size will be used. Note that there seems to be error handling missing in the kernel to detect when the provided vector is too small. This means a too small vector could lead to memory corruption in the process. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8cxx_source.html#l00014">14</a> of file <a class="el" href="Tracee_8cxx_source.html">Tracee.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   14</span>                                                                                                               {</div>
<div class="line"><span class="lineno">   15</span> </div>
<div class="line"><span class="lineno">   16</span>        <span class="keywordflow">if</span> (instructions.empty()) {</div>
<div class="line"><span class="lineno">   17</span>                <span class="keyword">const</span> <span class="keyword">auto</span> num_progs = this-&gt;request(ptrace::Request::SECCOMP_GET_FILTER, prog_index);</div>
<div class="line"><span class="lineno">   18</span>                instructions.resize(*num_progs);</div>
<div class="line"><span class="lineno">   19</span>        }</div>
<div class="line"><span class="lineno">   20</span> </div>
<div class="line"><span class="lineno">   21</span>        <span class="keyword">struct </span>sock_fprog fprog;</div>
<div class="line"><span class="lineno">   22</span>        fprog.len = instructions.size();</div>
<div class="line"><span class="lineno">   23</span>        fprog.filter = instructions.data();</div>
<div class="line"><span class="lineno">   24</span> </div>
<div class="line"><span class="lineno">   25</span>        <span class="keyword">const</span> <span class="keyword">auto</span> num_progs = this-&gt;request(ptrace::Request::SECCOMP_GET_FILTER, prog_index, &amp;fprog);</div>
<div class="line"><span class="lineno">   26</span> </div>
<div class="line"><span class="lineno">   27</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno">   28</span><span class="comment">         * This ptrace request actually seems to be missing a size check in</span></div>
<div class="line"><span class="lineno">   29</span><span class="comment">         * the kernel. We do communicate the number of filters we have in</span></div>
<div class="line"><span class="lineno">   30</span><span class="comment">         * fprog.len, but the kernel simply copies into the sock_fprog</span></div>
<div class="line"><span class="lineno">   31</span><span class="comment">         * whatever amount of data it has. This could lead to memory</span></div>
<div class="line"><span class="lineno">   32</span><span class="comment">         * corruption or a SIGSEGV.</span></div>
<div class="line"><span class="lineno">   33</span><span class="comment">         * TODO: test what exactly happens.</span></div>
<div class="line"><span class="lineno">   34</span><span class="comment">         */</span></div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span>        <span class="keywordflow">if</span> (*num_progs &lt; 0 || <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">long</span><span class="keyword">&gt;</span>(*num_progs) &gt;= instructions.size()) {</div>
<div class="line"><span class="lineno">   37</span>                cosmos_throw (RuntimeError(<span class="stringliteral">&quot;seccomp filter array size inconsistency&quot;</span>));</div>
<div class="line"><span class="lineno">   38</span>        }</div>
<div class="line"><span class="lineno">   39</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a137298b99ea1ec58e7bf1463b9e38d13" name="a137298b99ea1ec58e7bf1463b9e38d13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a137298b99ea1ec58e7bf1463b9e38d13">&#9670;&#160;</a></span>getSeccompRetDataEventMsg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t cosmos::Tracee::getSeccompRetDataEventMsg </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the SECCOMP_RET_DATA in the context of a ptrace-event-stop. </p>
<p>This request is only valid during a ptrace-event-stop when <a class="el" href="ptrace_8hxx.html#a9a489662d1a635d981aed845ab5d146fa2d110fe82951e4d5b615dae703b4eb9c" title="Stop triggered by a seccomp rule on tracee syscall entry.">ptrace::Event::SECCOMP</a> is reported.</p>
<p>The return value is the 16-bit value known as SECCOMP_RET_DATA, see <code>seccomp(2)</code>. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00344">344</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  344</span>                                                   {</div>
<div class="line"><span class="lineno">  345</span>                <span class="keyword">const</span> <span class="keyword">auto</span> seccomp_ret_data = <a class="code hl_function" href="#afb7e548fe0ae620ca51a784a55763324">getEventMsg</a>();</div>
<div class="line"><span class="lineno">  346</span>                <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span>uint16_t<span class="keyword">&gt;</span>(seccomp_ret_data);</div>
<div class="line"><span class="lineno">  347</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0ea2fdf1b7bd9aaa4915f52c772013b" name="ac0ea2fdf1b7bd9aaa4915f52c772013b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0ea2fdf1b7bd9aaa4915f52c772013b">&#9670;&#160;</a></span>getSigInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::getSigInfo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcosmos_1_1SigInfo.html">SigInfo</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>info</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obtain information about the signal that caused the stop. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8cxx_source.html#l00061">61</a> of file <a class="el" href="Tracee_8cxx_source.html">Tracee.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   61</span>                                           {</div>
<div class="line"><span class="lineno">   62</span>        this-&gt;request(ptrace::Request::GETSIGINFO, <span class="keyword">nullptr</span>, info.raw());</div>
<div class="line"><span class="lineno">   63</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af0dcf6d0867ecd5b20a77c2e1a803f6a" name="af0dcf6d0867ecd5b20a77c2e1a803f6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0dcf6d0867ecd5b20a77c2e1a803f6a">&#9670;&#160;</a></span>getSigMask()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::getSigMask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcosmos_1_1SigSet.html">SigSet</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>set</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Obtain the tracee's mask of blocked signals. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00302">302</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  302</span>                                           {</div>
<div class="line"><span class="lineno">  303</span>                this-&gt;request(ptrace::Request::GETSIGMASK, <span class="keyword">sizeof</span>(*set.raw()), set.raw());</div>
<div class="line"><span class="lineno">  304</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad868f8e5d6b18b4ef2c569fdb4f98c35" name="ad868f8e5d6b18b4ef2c569fdb4f98c35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad868f8e5d6b18b4ef2c569fdb4f98c35">&#9670;&#160;</a></span>getSyscallInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::getSyscallInfo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcosmos_1_1ptrace_1_1SyscallInfo.html">ptrace::SyscallInfo</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>info</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns system call information in the context of the current ptrace stop. </p>
<p>This request is only valid during syscall-entry-stop, syscall-exit-stop or ptrace-event-stop for <a class="el" href="ptrace_8hxx.html#a9a489662d1a635d981aed845ab5d146fa2d110fe82951e4d5b615dae703b4eb9c" title="Stop triggered by a seccomp rule on tracee syscall entry.">ptrace::Event::SECCOMP</a>.</p>
<p>Depending on the type of stop that occurred <code>info</code> will contain different data, thus only certain parts of the struct are accessible via std::optional return values. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8cxx_source.html#l00053">53</a> of file <a class="el" href="Tracee_8cxx_source.html">Tracee.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   53</span>                                                         {</div>
<div class="line"><span class="lineno">   54</span>        <span class="keyword">const</span> <span class="keyword">auto</span> obtained = this-&gt;request(ptrace::Request::GET_SYSCALL_INFO, <span class="keyword">sizeof</span>(*info.raw()), info.raw());</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>        <span class="keywordflow">if</span> (*obtained &lt; 0 || <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">long</span><span class="keyword">&gt;</span>(*obtained) &gt; <span class="keyword">sizeof</span>(*info.raw())) {</div>
<div class="line"><span class="lineno">   57</span>                cosmos_throw (RuntimeError(<span class="stringliteral">&quot;excess SYSCALL_INFO data, truncation occurred!&quot;</span>));</div>
<div class="line"><span class="lineno">   58</span>        }</div>
<div class="line"><span class="lineno">   59</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a63c81ded0c902d5ec3ccbc9966749d13" name="a63c81ded0c902d5ec3ccbc9966749d13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63c81ded0c902d5ec3ccbc9966749d13">&#9670;&#160;</a></span>interrupt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::interrupt </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Interrupt the tracee. </p>
<p>This works only on tracees attached via <a class="el" href="#a968432f97b30f27034234657f4feaa6b" title="Seize a tracee.">seize()</a>. As a result to the interrupt the tracee can enter:</p>
<ul>
<li>syscall-exit-stop if <a class="el" href="ptrace_8hxx.html#a5c84789f5ce6e305df719009e982a157a45f1e61f22cb04eb7a6a39016b56db9b" title="Restart the stopped tracee like CONT, but arrange for the tracee to be stopped at entry/exit to/from ...">ptrace::Request::SYSCALL</a> is in effect. The interrupted system call is restarted when the tracee is restarted.</li>
<li>if the tracee was already stopped by a signal and <a class="el" href="ptrace_8hxx.html#a5c84789f5ce6e305df719009e982a157ac1f9314a03f63f33410be3489b12b29b" title="Restart a stopped tracee, but let it enter a SIGSTOP like state. Works only for SEIZE&#39;d tracees.">ptrace::Request::LISTEN</a> was sent to it then a ptrace-event-stop is reported with the stop signal.</li>
<li>if another ptrace-stop is triggered in parallel, then this stop happens.</li>
<li>otherwise a ptrace-event-stop for signal SIGTRAP happens. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00156">156</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  156</span>                         {</div>
<div class="line"><span class="lineno">  157</span>                this-&gt;request(ptrace::Request::INTERRUPT);</div>
<div class="line"><span class="lineno">  158</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9f5eeb63d1485e982060ea22d1298573" name="a9f5eeb63d1485e982060ea22d1298573"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f5eeb63d1485e982060ea22d1298573">&#9670;&#160;</a></span>peekData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long cosmos::Tracee::peekData </td>
          <td>(</td>
          <td class="paramtype">const long *</td>          <td class="paramname"><span class="paramname"><em>addr</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read one word of data from the tracee's memory. </p>
<p><code>addr</code> specifies the address in the tracee's memory to read a word from.</p>
<p>The size of the word is defined by the type of operating system and architecture of the system. On Linux no differentiation between TEXT and DATA is made, thus only DATA is offered here. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00179">179</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  179</span>                                              {</div>
<div class="line"><span class="lineno">  180</span>                <span class="keywordflow">return</span> *(this-&gt;request(ptrace::Request::PEEKDATA, addr));</div>
<div class="line"><span class="lineno">  181</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a0869e4a7832b750f363f93a3e0d361" name="a2a0869e4a7832b750f363f93a3e0d361"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a0869e4a7832b750f363f93a3e0d361">&#9670;&#160;</a></span>peekSigInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classcosmos_1_1SigInfo.html">SigInfo</a> &gt; cosmos::Tracee::peekSigInfo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcosmos_1_1ptrace_1_1PeekSigInfo.html">ptrace::PeekSigInfo</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>settings</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obtains <a class="el" href="classcosmos_1_1SigInfo.html" title="Signal information struct used when receiving signals.">SigInfo</a> structures pending for the tracee. </p>
<p>Based on <code>settings</code> obtain a numer of <a class="el" href="classcosmos_1_1SigInfo.html" title="Signal information struct used when receiving signals.">SigInfo</a> structures pending for the tracee. <code>settings</code> define how many <a class="el" href="classcosmos_1_1SigInfo.html" title="Signal information struct used when receiving signals.">SigInfo</a> will be retrieved at max and from what position in the signal queue.</p>
<p>There is no way to know how many entries exist currently (this information can also rapidly change). If no more <a class="el" href="classcosmos_1_1SigInfo.html" title="Signal information struct used when receiving signals.">SigInfo</a> structures exist at the given position then a short or zero item count is returned. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8cxx_source.html#l00069">69</a> of file <a class="el" href="Tracee_8cxx_source.html">Tracee.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   69</span>                                                                        {</div>
<div class="line"><span class="lineno">   70</span>        <span class="keyword">const</span> <span class="keyword">auto</span> raw_settings = settings.raw();</div>
<div class="line"><span class="lineno">   71</span>        std::vector&lt;SigInfo&gt; ret;</div>
<div class="line"><span class="lineno">   72</span>        ret.resize(raw_settings-&gt;nr);</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>        <span class="keyword">const</span> <span class="keyword">auto</span> num_entries = this-&gt;request(</div>
<div class="line"><span class="lineno">   75</span>                        ptrace::Request::PEEKSIGINFO, raw_settings, ret.data());</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>        ret.resize(*num_entries);</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>        <span class="keywordflow">return</span> ret;</div>
<div class="line"><span class="lineno">   80</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab885b1d2e0bbc99d63db5a32de435b6c" name="ab885b1d2e0bbc99d63db5a32de435b6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab885b1d2e0bbc99d63db5a32de435b6c">&#9670;&#160;</a></span>peekUser()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long cosmos::Tracee::peekUser </td>
          <td>(</td>
          <td class="paramtype">const long *</td>          <td class="paramname"><span class="paramname"><em>offset</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read one word of data from the tracee's user area. </p>
<p>The user area refers to the kernel's <code>struct user</code> which contains data about registers and other information about the process. This data is highly OS and architecture specific and could yield unexpected results.</p>
<p>The given parameter is an <code>offset</code> into <code>struct user</code> where to read from. The offset typically needs to be word-aligned. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00198">198</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  198</span>                                                {</div>
<div class="line"><span class="lineno">  199</span>                <span class="keywordflow">return</span> *(this-&gt;request(ptrace::Request::PEEKUSER, offset));</div>
<div class="line"><span class="lineno">  200</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae91657195f3ad8a45c6ef05577949824" name="ae91657195f3ad8a45c6ef05577949824"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae91657195f3ad8a45c6ef05577949824">&#9670;&#160;</a></span>pid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="proc_2types_8hxx.html#a4c274565c8010d58379ba7ac3d6e0d9a">ProcessID</a> cosmos::Tracee::pid </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00069">69</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   69</span>                              {</div>
<div class="line"><span class="lineno">   70</span>                <span class="keywordflow">return</span> m_pid;</div>
<div class="line"><span class="lineno">   71</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a871a3986682db6c4745933eeb0e2f67b" name="a871a3986682db6c4745933eeb0e2f67b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a871a3986682db6c4745933eeb0e2f67b">&#9670;&#160;</a></span>pokeData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::pokeData </td>
          <td>(</td>
          <td class="paramtype">const long *</td>          <td class="paramname"><span class="paramname"><em>addr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>value</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Write one word of data into the tracee's memory. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00184">184</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  184</span>                                                    {</div>
<div class="line"><span class="lineno">  185</span>                this-&gt;request(ptrace::Request::POKEDATA, addr, value);</div>
<div class="line"><span class="lineno">  186</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af0a46160569f645dbfbf01818f038da5" name="af0a46160569f645dbfbf01818f038da5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0a46160569f645dbfbf01818f038da5">&#9670;&#160;</a></span>pokeUser()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::pokeUser </td>
          <td>(</td>
          <td class="paramtype">const long *</td>          <td class="paramname"><span class="paramname"><em>offset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long</td>          <td class="paramname"><span class="paramname"><em>value</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Change one word of data in the tracee's user area. </p>
<p>This changes on word of data in the tracee's user area. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="#ab885b1d2e0bbc99d63db5a32de435b6c" title="Read one word of data from the tracee&#39;s user area.">peekUser()</a>. <code>offset</code> typically needs to be word-aligned. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00207">207</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  207</span>                                                      {</div>
<div class="line"><span class="lineno">  208</span>                this-&gt;request(ptrace::Request::POKEUSER, offset, value);</div>
<div class="line"><span class="lineno">  209</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e0e790421dea9708d1fba889ed9b34e" name="a4e0e790421dea9708d1fba889ed9b34e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e0e790421dea9708d1fba889ed9b34e">&#9670;&#160;</a></span>request() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename ADDR  = void*, typename DATA  = void*&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt; long &gt; cosmos::Tracee::request </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ptrace_8hxx.html#a5c84789f5ce6e305df719009e982a157">ptrace::Request</a></td>          <td class="paramname"><span class="paramname"><em>req</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ADDR</td>          <td class="paramname"><span class="paramname"><em>addr</em></span><span class="paramdefsep"> = </span><span class="paramdefval">nullptr</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DATA</td>          <td class="paramname"><span class="paramname"><em>data</em></span><span class="paramdefsep"> = </span><span class="paramdefval">nullptr</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00416">416</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  416</span>                                                                                                           {</div>
<div class="line"><span class="lineno">  417</span>                <span class="comment">// First cast to const void* then remove const, this allows to</span></div>
<div class="line"><span class="lineno">  418</span>                <span class="comment">// pass in const pointers. The compiler cannot understand that</span></div>
<div class="line"><span class="lineno">  419</span>                <span class="comment">// ptrace() won&#39;t change the pointed-to data according to</span></div>
<div class="line"><span class="lineno">  420</span>                <span class="comment">// contract.</span></div>
<div class="line"><span class="lineno">  421</span>                <span class="keywordflow">return</span> cosmos::ptrace::trace(req, m_pid,</div>
<div class="line"><span class="lineno">  422</span>                                <span class="keyword">const_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(addr)),</div>
<div class="line"><span class="lineno">  423</span>                                <span class="keyword">const_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(data)));</div>
<div class="line"><span class="lineno">  424</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c53169a343594c9df341f2966951588" name="a0c53169a343594c9df341f2966951588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c53169a343594c9df341f2966951588">&#9670;&#160;</a></span>request() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DATA  = void*&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::optional&lt; long &gt; cosmos::Tracee::request </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ptrace_8hxx.html#a5c84789f5ce6e305df719009e982a157">ptrace::Request</a></td>          <td class="paramname"><span class="paramname"><em>req</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::nullptr_t</td>          <td class="paramname"><span class="paramname"><em></em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DATA</td>          <td class="paramname"><span class="paramname"><em>data</em></span><span class="paramdefsep"> = </span><span class="paramdefval">nullptr</span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00431">431</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  431</span>                                                                                                    {</div>
<div class="line"><span class="lineno">  432</span>                <span class="keywordflow">return</span> request(req, <span class="keyword">static_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(<span class="keyword">nullptr</span>), data);</div>
<div class="line"><span class="lineno">  433</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af50c00c9d07f00812e55e288c97d0c40" name="af50c00c9d07f00812e55e288c97d0c40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af50c00c9d07f00812e55e288c97d0c40">&#9670;&#160;</a></span>restart()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::restart </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="#a13c909fd8690131c70200894ed2630de">RestartMode</a></td>          <td class="paramname"><span class="paramname"><em>mode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::optional&lt; <a class="el" href="classcosmos_1_1Signal.html">Signal</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>signal</em></span><span class="paramdefsep"> = </span><span class="paramdefval">{}</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Continues a traced process, optionally delivering <code>signal</code>. </p>
<p>If the current ptrace stop state doesn't allow injection of a signal, then none should be specified. Generally only a signal-stop state allows injection of signals.</p>
<p>If signal information has been overwritten by using ptrace::set_siginfo(), then the <code>signal</code> passed here must match, otherwise the behaviour will be undefined. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00134">134</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  134</span>                                                                                {}) {</div>
<div class="line"><span class="lineno">  135</span>                <span class="comment">// data here takes the plain signal number, 0 means &quot;don&#39;t inject a signal&quot;.</span></div>
<div class="line"><span class="lineno">  136</span>                this-&gt;request(<span class="keyword">static_cast&lt;</span>ptrace::Request<span class="keyword">&gt;</span>(mode),</div>
<div class="line"><span class="lineno">  137</span>                                <span class="keyword">nullptr</span>,</div>
<div class="line"><span class="lineno">  138</span>                                mode != RestartMode::LISTEN &amp;&amp; signal ? signal-&gt;raw() : SignalNr{0});</div>
<div class="line"><span class="lineno">  139</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a968432f97b30f27034234657f4feaa6b" name="a968432f97b30f27034234657f4feaa6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a968432f97b30f27034234657f4feaa6b">&#9670;&#160;</a></span>seize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::seize </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcosmos_1_1BitMask.html">ptrace::Opts</a></td>          <td class="paramname"><span class="paramname"><em>opts</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Seize a tracee. </p>
<p>This is the modern way of making a process a tracee. This does not stop the process. The seize property is inherited to matching child processes of the tracee if one of the options Opt::TRACEFORK, Opt::TRACEVFORK or Opt::TRACECLONE is set on the tracee.</p>
<p>Initial tracing options are set atomically alongside the SEIZE request. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00088">88</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   88</span>                                          {</div>
<div class="line"><span class="lineno">   89</span>                this-&gt;request(ptrace::Request::SEIZE, <span class="keyword">nullptr</span>, opts.raw());</div>
<div class="line"><span class="lineno">   90</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a11f4b897829d82773cd4420a554243fa" name="a11f4b897829d82773cd4420a554243fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11f4b897829d82773cd4420a554243fa">&#9670;&#160;</a></span>setFloatRegisters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::setFloatRegisters </td>
          <td>(</td>
          <td class="paramtype">const struct user_fpregs_struct &amp;</td>          <td class="paramname"><span class="paramname"><em>out</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Modify the tracee's floating point registers. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a2cda1e5d38ad2243b4cee1bac1911404" title="Modify the tracee&#39;s general purpose registers.">setRegisters()</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00252">252</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  252</span>                                                                     {</div>
<div class="line"><span class="lineno">  253</span>                this-&gt;request(ptrace::Request::SETFPREGS, <span class="keyword">nullptr</span>, &amp;out);</div>
<div class="line"><span class="lineno">  254</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa3b5f159473a8be7a0e74c1b593f58e2" name="aa3b5f159473a8be7a0e74c1b593f58e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3b5f159473a8be7a0e74c1b593f58e2">&#9670;&#160;</a></span>setOptions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::setOptions </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcosmos_1_1BitMask.html">ptrace::Opts</a></td>          <td class="paramname"><span class="paramname"><em>opts</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set tracing options for the given tracee. </p>
<p>This call completely defines the options in effect for the given tracee. These options can be inherited by new tracees that are auto-attached via the TRACEFORK, TRACEVFORK and TRACECLONE options. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00166">166</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  166</span>                                               {</div>
<div class="line"><span class="lineno">  167</span>                this-&gt;request(ptrace::Request::SETOPTIONS, <span class="keyword">nullptr</span>, opts.raw());</div>
<div class="line"><span class="lineno">  168</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2cda1e5d38ad2243b4cee1bac1911404" name="a2cda1e5d38ad2243b4cee1bac1911404"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cda1e5d38ad2243b4cee1bac1911404">&#9670;&#160;</a></span>setRegisters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::setRegisters </td>
          <td>(</td>
          <td class="paramtype">const struct user_regs_struct &amp;</td>          <td class="paramname"><span class="paramname"><em>out</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Modify the tracee's general purpose registers. </p>
<p>Some register modifications may be disallowed by the kernel to maintain integrity of the tracee. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00231">231</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  231</span>                                                              {</div>
<div class="line"><span class="lineno">  232</span>                <span class="comment">// NOTE: see getRegisters() about Sparc architecture</span></div>
<div class="line"><span class="lineno">  233</span>                this-&gt;request(ptrace::Request::SETREGS, <span class="keyword">nullptr</span>, &amp;out);</div>
<div class="line"><span class="lineno">  234</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6524b926fdaaece495a139a7c2021742" name="a6524b926fdaaece495a139a7c2021742"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6524b926fdaaece495a139a7c2021742">&#9670;&#160;</a></span>setRegisterSet()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::setRegisterSet </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="ptrace_8hxx.html#a8cf6234aa2df092f270d9a5de0ba190f">ptrace::RegisterType</a></td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcosmos_1_1OutputMemoryRegion.html">OutputMemoryRegion</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>iovec</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Modify a set of registers in the tracee. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00270">270</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  270</span>                                                                                      {</div>
<div class="line"><span class="lineno">  271</span>                this-&gt;request(ptrace::Request::SETREGSET, type, iovec.asIovec());</div>
<div class="line"><span class="lineno">  272</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a734c8731ffacba884ddaebfa46d76892" name="a734c8731ffacba884ddaebfa46d76892"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a734c8731ffacba884ddaebfa46d76892">&#9670;&#160;</a></span>setSigInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::setSigInfo </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcosmos_1_1SigInfo.html">SigInfo</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>info</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set signal information for the tracee. </p>
<p>This will affect only signals that would normally be delivered to the tracee and were caught by the tracer. These signals can be hard to tell from synthetic signals generated by ptrace() itself.</p>
<p>When changing the signal information this way then the signal passed to <a class="el" href="#af50c00c9d07f00812e55e288c97d0c40" title="Continues a traced process, optionally delivering signal.">restart()</a> needs to match, to prevent undefined behaviour. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8cxx_source.html#l00065">65</a> of file <a class="el" href="Tracee_8cxx_source.html">Tracee.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   65</span>                                           {</div>
<div class="line"><span class="lineno">   66</span>        this-&gt;request(ptrace::Request::SETSIGINFO, <span class="keyword">nullptr</span>, info.raw());</div>
<div class="line"><span class="lineno">   67</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a173bcd08cf9740bc26cb5a2168c12c70" name="a173bcd08cf9740bc26cb5a2168c12c70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a173bcd08cf9740bc26cb5a2168c12c70">&#9670;&#160;</a></span>setSigMask()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void cosmos::Tracee::setSigMask </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcosmos_1_1SigSet.html">SigSet</a> &amp;</td>          <td class="paramname"><span class="paramname"><em>set</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Change the tracee's mask of blocked signals. </p>

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00307">307</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  307</span>                                           {</div>
<div class="line"><span class="lineno">  308</span>                this-&gt;request(ptrace::Request::SETSIGMASK, <span class="keyword">sizeof</span>(*set.raw()), set.raw());</div>
<div class="line"><span class="lineno">  309</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a17d3745c4cb054345cf75af09bfa5f47" name="a17d3745c4cb054345cf75af09bfa5f47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17d3745c4cb054345cf75af09bfa5f47">&#9670;&#160;</a></span>valid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool cosmos::Tracee::valid </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00073">73</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   73</span>                           {</div>
<div class="line"><span class="lineno">   74</span>                <span class="keywordflow">return</span> pid() != ProcessID::INVALID;</div>
<div class="line"><span class="lineno">   75</span>        }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a1f61416f3d6309755f5a8b5050227883" name="a1f61416f3d6309755f5a8b5050227883"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f61416f3d6309755f5a8b5050227883">&#9670;&#160;</a></span>m_pid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="proc_2types_8hxx.html#a4c274565c8010d58379ba7ac3d6e0d9a">ProcessID</a> cosmos::Tracee::m_pid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Tracee_8hxx_source.html#l00437">437</a> of file <a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/proc/<a class="el" href="Tracee_8hxx_source.html">Tracee.hxx</a></li>
<li>src/proc/<a class="el" href="Tracee_8cxx_source.html">Tracee.cxx</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>cosmos</b></li><li class="navelem"><a class="el" href="classcosmos_1_1Tracee.html">Tracee</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
